<CourseFloatingBanner 
  classNames="absolute z-10 right-0 top-0"
  notebooks={[
    {label: "Google Colab", value: "https://colab.research.google.com/#fileId=https://huggingface.co/agents-course/notebooks/blob/main/fr/unit2/smolagents/tool_calling_agents.ipynb"},
]}
askForHelpUrl="http://hf.co/join/discord" />

# Ã‰crire des actions sous forme d'extraits de code ou de blobs JSON

> [!TIP]
> Vous pouvez suivre le code dans <a href="https://huggingface.co/agents-course/notebooks/blob/main/fr/unit2/smolagents/tool_calling_agents.ipynb" target="_blank">ce <i>notebook</i></a> que vous pouvez exÃ©cuter avec Google Colab.

Les `ToolCallingAgent` sont le deuxiÃ¨me type d'agent disponible dans `smolagents`. Contrairement aux `CodeAgent` qui utilisent des extraits de code en Python, ces agents **utilisent les capacitÃ©s d'appel d'outils intÃ©grÃ©es des fournisseurs de LLM** pour gÃ©nÃ©rer des appels d'outils sous forme de **structures JSON**. C'est l'approche standard utilisÃ©e par OpenAI, Anthropic et de nombreux autres fournisseurs.

Regardons un exemple. Quand Alfred veut rechercher des services de restauration et des idÃ©es de fÃªte, un `CodeAgent` gÃ©nÃ©rerait et exÃ©cuterait du code Python comme ceci :

```python
for query in [
    "Meilleurs services de restauration Ã  Gotham City", 
    "IdÃ©es de thÃ¨me de fÃªte pour super-hÃ©ros"
]:
    print(web_search(f"Rechercher : {query}"))
```

Un `ToolCallingAgent` crÃ©erait plutÃ´t une structure JSON :

```python
[
    {"name": "web_search", "arguments": "Meilleurs services de restauration Ã  Gotham City"},
    {"name": "web_search", "arguments": "IdÃ©es de thÃ¨me de fÃªte pour super-hÃ©ros"}
]
```

Ce blob JSON est ensuite utilisÃ© pour exÃ©cuter les appels d'outils.

Bien que `smolagents` se concentre principalement sur les `CodeAgent` puisqu'[ils performent mieux dans l'ensemble](https://huggingface.co/papers/2402.01030), les `ToolCallingAgent` peuvent Ãªtre efficaces pour des systÃ¨mes simples qui ne nÃ©cessitent pas de gestion de variables ou d'appels d'outils complexes.

![Code vs JSON Actions](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/transformers/code_vs_json_actions.png)  

## Comment fonctionnent *ToolCallingAgent* ?  

Les `ToolCallingAgent` suivent le mÃªme *workflow* multi-Ã©tapes que les `CodeAgent` (voir la [section prÃ©cÃ©dente](./code_agents) pour plus de dÃ©tails). 

La diffÃ©rence clÃ© est dans **la faÃ§on dont ils structurent leurs actions** : au lieu de code exÃ©cutable, ils **gÃ©nÃ¨rent des objets JSON qui spÃ©cifient les noms d'outils et les arguments**. Le systÃ¨me **analyse ensuite ces instructions** pour exÃ©cuter les outils appropriÃ©s.

## Exemple : exÃ©cuter un *ToolCallingAgent*  

Revisitions l'exemple prÃ©cÃ©dent oÃ¹ Alfred a commencÃ© les prÃ©paratifs de la fÃªte, mais cette fois nous utiliserons un `ToolCallingAgent` pour mettre en Ã©vidence la diffÃ©rence. Nous allons construire un agent qui peut rechercher sur le web en utilisant DuckDuckGo, tout comme dans notre exemple de `CodeAgent`. La seule diffÃ©rence est le type d'agent ; le *framework* gÃ¨re tout le reste :

```python
from smolagents import ToolCallingAgent, DuckDuckGoSearchTool, InferenceClientModel

agent = ToolCallingAgent(tools=[DuckDuckGoSearchTool()], model=InferenceClientModel())

agent.run("Recherche les meilleures recommandations musicales pour une fÃªte au manoir des Wayne.")
```

Lorsque vous examinez la trace de l'agent, au lieu de voir `Executing parsed code:`, vous verrez quelque chose comme :

```text
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Calling tool: 'web_search' with arguments: {'query': "meilleures recommandations musicales pour une fÃªte au     â”‚
â”‚ manoir des Wayne"}                                                                                              â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```  

L'agent gÃ©nÃ¨re un appel d'outil structurÃ© que le systÃ¨me traite pour produire la sortie, plutÃ´t que d'exÃ©cuter directement du code.

Maintenant que nous comprenons les deux types d'agents, nous pouvons choisir celui adaptÃ© Ã  nos besoins. Continuons Ã  explorer `smolagents` pour faire de la fÃªte d'Alfred un succÃ¨s ! ğŸ‰

## Ressources

- [Documentation ToolCallingAgent](https://huggingface.co/docs/smolagents/v1.8.1/en/reference/agents#smolagents.ToolCallingAgent) - Documentation officielle de `ToolCallingAgent`